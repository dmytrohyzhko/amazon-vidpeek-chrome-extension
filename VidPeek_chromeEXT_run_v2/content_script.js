!function(t){var e=function(e,a,o){for(var s="",r=0;r<a.length;r++){var n=t(a[r],e);if(n.length>0&&n[o]&&(s=n.first()[o]()))return s}return s},a=function(t){return e(t,["input#ASIN","input#attach-baseAsin",'input[name="designAsin"]'],"val")},o=function(t){return t.text()};function s(s,r){var n=a(s),i=e(s,["#productTitle","h1#title"],"text").trim(),c=e(s,["#centerCol .a-price .a-offscreen","#gc-buy-box .a-color-price"],"text");c||(c=s.find("#twister-plus-price-data-price").val());var d,l,u=s.find("#landingImage, #img-canvas img, #ebooks-img-canvas img").attr("src"),h=e(s,["#acrCustomerReviewText",'#gc-detail-page-center-column a[href*="/product-reviews/"]'],"text"),p=s.find("#searchDropdownBox option:selected");(l=p.val())&&(l=l.replace("search-alias=",""),d=p.text());var m=[],f=s.find("#productDetails_feature_div,#detailBulletsWrapper_feature_div,#productDetails_detailBullets_sections1,#productDetails_flatSectionTables,#gc-dp-btf-product-features").find('a[href*="/bestsellers/"]');if("all"===l||"aps"===l){var v,g=f.first();g&&(v=g.attr("href"))&&(v=v.match(/sellers\/([^\/]+)\//))&&(l=v[1],d=(d=g.text().split(/\s(in|en)\s/)).length>1?d[d.length-1]:l)}f.each(function(e,a){try{var o=t(a),s=o.parent().text().split(/#|nº/)[1].split(" ");m.push([parseInt(s[0].replace(/\D+/g,"")),s.slice(2).join(" ").split("(")[0],o.prop("href")])}catch(t){}}),m.sort(function(t,e){return t[0]===e[0]?0:t[0]<e[0]?-1:1});var b=s.find("head").text().match(/ue_mid.+'(\w+)/);b=b?b[1]:"";var y={name:i,price:c,asin:n,category:l,category_name:d,image:u,url:"https://www.amazon.com/dp/"+n,rating:parseFloat(s.find("#acrPopover").attr("title")),marketplace_id:b,review_count:h?parseInt(h.replace(/,/g,"")||"",10):0,best_sellers_rank:m},w=0,x=0,_=0,S=[];s.find("#vse-vw-dp-vse-related-videos li.a-carousel-card > div").each(function(e,a){var o=t(a),s=o.attr("data-title"),r=o.attr("data-video-image-url-unchanged"),n="https://www.amazon.com"+o.attr("data-vdp-url"),i=o.attr("data-vendor-name").trim(),c=(e=o.attr("data-profile-link"),"influencer"===(o.attr("data-creator-type")||"").toLowerCase()),d="rvs_g2"===(o.attr("data-group-type")||"").toLowerCase();c&&w++,d&&x++,d&&c&&_++,S.push({title:s||"",image:r||"",url:n,author_name:i||"",author_url:e?"https://www.amazon.com"+e:"",is_influencer:c,duration:o.attr("data-formatted-duration")||"",is_related_video:d,is_customer_review:o.find(".IB_G3").length>0||o.find(".G3")>0||"rvs_g3"===(o.attr("data-group-type")||"").toLowerCase()})}),y.bottom_carousel={videos:S,related_video_count:x,influencer_video_count:w,related_influencer_count:_};var B=[];s.find("[data-a-carousel-options]").each(function(a,o){try{var s=t(o),r=JSON.parse(s.attr("data-a-carousel-options"));if(r&&(r.initialSeenAsins||r.ajax)){var n=s.find("li"),i={products:[],name:"",ajax:{url:r.ajax?r.ajax.url:"",params:r.ajax?r.ajax.params:""},set_size:r.set_size||""},c=s.find("h2.a-carousel-heading").first().text();if(!c)return;i.name=c.trim(),n.each(function(a,o){var s,r=t(o),n=e(r,[".sponsored-products-truncator-truncated","a div.p13n-sc-truncate-fallback",".a-section span.a-size-base"],"text"),c=e(r,["span.a-color-price",".a-price .a-offscreen"],"text").trim(),d=r.find('i[class*="a-icon-star"]'),l=(s=d.next().text().trim()).length?parseFloat(s.replace(/[^\d.]/g,"")):0,u=d.text().trim();u||(u=(u=(d.attr("class")||"").match(/-([\d-]+)/))?u[1]:0),u=u?parseFloat(u.replace("-",".")):0;var h=r.find("img").prop("src"),p=r.find('a[target="_top"],a.a-link-normal').prop("href"),m=decodeURIComponent(p).match(/\/(dp|gp\/product)\/([A-Z0-9]{10})/);n&&m&&i.products.push({name:n,price:c,review_count:l,rating:u,image:h,asin:m&&m[2]?m[2]:"",url:p})}),i.products.length&&B.push(i)}}catch(s){console.log(s)}}),y.product_carousels=B;var C=0,T=0,P=function(){C&&T&&r&&r(y)};const k=s.find("#altImages")[0];null!=k&&(null!==k.querySelector(".videoThumbnail")||null!==k.querySelector(".videoBlockIngress")||null!==k.querySelector(".videoBlockDarkIngress"))?fetch("https://www.amazon.com/vap/ew/subcomponent/relatedvideos",{method:"POST",headers:{"Content-Type":"application/json","x-requested-with":"XMLHttpRequest"},body:`{"pageContext":{"page":"DetailPage","placement":"ImageBlock","device":"Desktop","marketplaceID":"${b}","locale":"en_US","product":{"contentID":"${n}","contentIDType":"ASIN"},"video":{"contentID":"02cb97edd0b7477f91da3ae10f9f1d0d","contentIDType":"ASIN","videoURL":"https://m.media-amazon.com/images/S/vse-vms-transcoding-artifact-us-east-1-prod/d8dbcdeb-91e2-4cc9-b94e-60a2f3b59e3c/default.jobtemplate.mp4.480.mp4","imageURL":"https://m.media-amazon.com/images/I/91InKrQg+6L.SX522_.jpg"},"requestId":"7S7W3YY93RJZHT3EZK54","weblabContext":[{"name":"","assignment":"","ignoreForG2S2Key":true}],"metadata":{"ProductTitle":"Voniko - Premium Grade AAA Batteries - 24 Pack - Alkaline Triple A Battery - Ultra Long-Lasting, Leakproof 1.5v Batteries - 10-Year Shelf Life"}},"configuration":{"id":"div-relatedvideos","type":"relatedvideos","binder":"relatedvideos","loader":"lazyload","features":{"features":{"verticalcarousel":"true","hide_default_buttons":"true","first_item_flush_left":"true","pagestate":"dp_vse_rvc","reftagprefix":"dp_vse_ibvc","carouselName":"vse-ib-rvs","count":"16","useLazyLoad":"false","hidePlayIcon":"true","hideCustomerReviewPrefix":"true","cssClass":"vse-hide-carousel-title","manufacturerVendorCodes":"V3MSA, Z7AX4, 137GO","segmentOneHeaderId":"vse_ib_segment_one","segmentTwoHeaderId":"vse_ib_segment_two","segmentThreeHeaderId":"vse_ib_segment_three","segmentOneHeaderDefault":"Videos for this product","segmentTwoHeaderDefault":"Related videos","segmentThreeHeaderDefault":"Customer review videos","includeProfiles":"true","showCustomerReviewMetadata":"true","enableCustomerReviewVideos":"true"}},"sources":{"source":"VideoAdsDataAggregatorService"}}}`}).then(o).then(function(e){try{var a=t(t.parseHTML(e)).find(".vse-video-card"),o=0,s=0,r=0,n=[];a.each(function(e,a){var i=t(a),c=i.find(".vse-video-title-text").text().trim(),d=i.find(".vse-video-image img").attr("src"),l=i.find("a.vse-carousel-item").attr("href"),u=i.find(".vse-video-vendorname").text().trim(),h=i.find(".vse-creator-profile a").attr("href"),p=i.find(".vse-video-duration").text().trim(),m=i.find(".vse-video-influencer-profile").length>0,f=i.find(".segment-title-IB_G1").length>0;m&&o++,f&&s++,f&&l.is_influencer&&r++,(m||f)&&n.push({title:c,image:d,url:"https://www.amazon.com/vdp"+l,author_name:u,author_url:h?"https://www.amazon.com"+h:"",is_influencer:m,duration:p,is_related_video:f,is_customer_review:i.find(".IB_G3").length>0||i.find(".G3").length>0})}),y.top_carousel={videos:n,related_video_count:s,influencer_video_count:o,related_influencer_count:r}}catch(t){}C=1,P()}).catch(function(){C=1,P()}):(y.top_carousel={videos:[],related_video_count:0,influencer_video_count:0,related_influencer_count:0},C=1,P()),fetch("https://www.amazon.com/product-reviews/"+n+"/ref=cm_cr_arp_d_viewopt_srt?pageNumber=1&sortBy=recent").then(o).then(function(a){try{var o=[],s=t(t.parseHTML(a)),r=e(s,['.AverageCustomerReviews i[class*="a-icon-star"] span',".AverageCustomerReviews .a-col-right span"],"text");r&&(r=parseFloat(r))&&r!=y.rating&&(y.rating=r),s.find(".review").each(function(e,a){var s=t(a),r=s.find(".a-profile-name").text().trim(),n="https://www.amazon.com"+s.find(".a-profile").attr("href"),i=s.find(".review-date").text().trim(),c=s.find(".review-title").text().trim()||"",d=s.find(".review-text").text().trim()||"",l=parseInt(s.find(".review-rating").text().trim()||"",10),u=s.find(".a-color-state").length>0;o.push({author_name:r||"",author_url:n,date:function(t){const e=t.match(/on\s(.*)$/);return e?e[1]:""}(i||""),title:c,text:d,rating:l,is_verified_purchase:u})}),y.reviews=o}catch(t){}T=1,P()}).catch(function(){T=1,P()})}var r=function(e,a,r){var n="c-"+e,i=Date.now(),c=i+36e5;chrome.storage.local.get(n,function(d){var l=d[n];l&&l._at&&i-l._at<c?r(l,a):fetch("https://www.amazon.com/dp/"+e).then(o).then(function(e){s(t((new DOMParser).parseFromString(e,"text/html")),function(t){t._at=i;var e={};e[n]=t,chrome.storage.local.set(e),r(t,a)})})})};t(function(){if(a()){var e=t('<div class="aext-btn"><img src="'+chrome.runtime.getURL("assets/images/icon-64.png")+'" alt="'+chrome.i18n.getMessage("extName")+'"></div>');t("body").append(e);var o='<div class="bloading"><div class="lds-ring"><div></div><div></div><div></div><div></div></div><p>Loading Data</p></div>',n=!1,i="",c=[["luxury","Luxury Stores","5"],["luxury-beauty","Premium Beauty","5"],["luxurystores","Luxury Stores","5"],["garden","Home & Kitchen","4"],["tools","Tools & Home Improvement","4"],["lawngarden","Garden & Outdoor","4"],["pets","Pet Supplies","4"],["electronics","Electronics","3"],["beauty","Beauty & Personal Care","3"],["mi","Musical Instruments","3"],["local-services","Home & Business Services","3"],["digital-music","Digital Music","2.50"],["grocery","Grocery & Gourmet Food","2.50"],["digital-video","Digital Video","2.50"],["book","Book","2.25"],["stripbooks","Books","2.25"],["sporting","Sports & Outdoors","2.25"],["kitchen","Kitchen & Dining","2.25"],["automotive","Automotive Parts & Accessories","2.25"],["baby-products","Baby","2.25"],["fashion","Clothing, Shoes & Jewelry","2"],["fashion-womens","Womens","2"],["fashion-womens-shoes","Womens shoes","2"],["fashion-mens","Mens","2"],["fashion-mens-shoes","Mens Shoes","2"],["fashion-girls","Girls","2"],["fashion-boys","Boys","2"],["fashion-baby","Baby","2"],["fashion-luggage","Luggage & Travel Gear","2"],["fashion-womens-watches","Women's Watches","2"],["fashion-mens-watches","Men's Watches","2"],["fashion-girls-watches","Girls' Watches","2"],["fashion-boys-watches","Boys' Watches","2"],["fashion-womens-accessories","Women's Accessories","2"],["fashion-mens-accessories","Men's Accessories","2"],["fashion-girls-accessories","Girl's Accessories","2"],["fashion-boys-accessories","Boy's Accessories","2"],["toys-and-games","Toys","1.50"],["amazonfresh","Amazon Fresh","1.50"],["computers","Computers","1.25"],["movies-tv","Amazon Fresh","1.25"],["television","Television","1"],["gift-cards","Gift Cards","0"],["mobile-apps","Mobile Apps","0"],["instant-video","Prime Video","0"]];e.on("click",function(){if(!n&&(d(),!i)){var e=t(document),a=e.scrollTop();t("html, body").animate({scrollTop:2*e.height()},2e3).animate({scrollTop:0},1500).animate({scrollTop:a},500),setTimeout(function(){s(t(document),function(t){var e='<?xml version="1.0" ?><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21,8.94a1.31,1.31,0,0,0-.06-.27l0-.09a1.07,1.07,0,0,0-.19-.28h0l-6-6h0a1.07,1.07,0,0,0-.28-.19.32.32,0,0,0-.09,0A.88.88,0,0,0,14.05,2H10A3,3,0,0,0,7,5V6H6A3,3,0,0,0,3,9V19a3,3,0,0,0,3,3h8a3,3,0,0,0,3-3V18h1a3,3,0,0,0,3-3V9S21,9,21,8.94ZM15,5.41,17.59,8H16a1,1,0,0,1-1-1ZM15,19a1,1,0,0,1-1,1H6a1,1,0,0,1-1-1V9A1,1,0,0,1,6,8H7v7a3,3,0,0,0,3,3h5Zm4-4a1,1,0,0,1-1,1H10a1,1,0,0,1-1-1V5a1,1,0,0,1,1-1h3V7a3,3,0,0,0,3,3h3Z" fill="#6563ff"/></svg>';var a=new Date;a.setHours(0,0,0,0),a=a.getTime();for(var o=0,s=0;s<t.reviews.length;s++){var r=t.reviews[s];try{var n=Math.ceil((a-new Date(r.date))/864e5);n>=0&&n<=6&&o++}catch(t){console.log(t)}"<div>"+r.rating+" - "+r.date+"</div>",r.rating,0}i+="<div>",i+='<button class="aext-related-product">Related products</button>',i+="</div>",i+='<div class="aext-area1">',i+='<div class="aext-meta-wraper apad">',i+="<div>",i+="<div><strong>ASIN: </strong><span>"+t.asin+'</span> <button class="aext-copy-button" data-copy="'+t.asin+'">'+e+"</button></div>",i+="<div><strong>Link: </strong><span>"+t.url+'</span> <button class="aext-copy-button" data-copy="'+t.url+'">'+e+"</button></div>",i+="<div><strong>Price: </strong><span>"+t.price+"</span></div>",i+="<div><strong>Rating: </strong><span>"+(t.rating||0)+'</span><span style="color:#ffa41c">★</span></div>',i+="<div><strong># Ratings: </strong><span>"+t.review_count+"</span></div>",i+="</div>";var d=t.best_sellers_rank;i+="<div>",i+="<div><strong>Last 7 days #Reviews: </strong>"+o+"</div>",i+="<div><strong>Best sellers rank</strong></div>";for(s=0;s<d.length;s++){var u=d[s];i+='<div><a href="'+u[2]+'">#'+u[0]+" - "+u[1]+"</a></div>"}i+="</div>",i+="</div>",i+="<table>",i+="<thead>",i+="<tr>",i+="<th></th>",i+="<th>Merchant Videos</th>",i+="<th>Influencer Videos</th>",i+="<th>Total Videos</th>",i+="</tr>",i+="</thead>",i+="<tbody>",i+="<tr>",i+="<td><strong>Top Carrousel</strong></td>",i+="<td>"+(t.top_carousel.videos.length-t.top_carousel.influencer_video_count)+"</td>",i+="<td>"+t.top_carousel.influencer_video_count+"</td>",i+="<td>"+t.top_carousel.videos.length+"</td>",i+="</tr>",i+="<tr>",i+="<td><strong>Bottom Carrousel</strong></td>",i+="<td>"+(t.bottom_carousel.videos.length-t.bottom_carousel.influencer_video_count)+"</td>",i+="<td>"+t.bottom_carousel.influencer_video_count+"</td>",i+="<td>"+t.bottom_carousel.videos.length+"</td>",i+="</tr>",i+="</tbody>",i+="</table>";var h="4";for(s=0;s<c.length;s++)c[s][0]==t.category&&(h=c[s][2]);var p=t.category_name,m=parseInt(t.price.replace(/[\D\.]+/,""));i+='<table class="extbb">',i+="<tr>",i+="<td><strong>Category:</strong> <span>"+p+"</span></td>",i+="<td><strong>Comission % in <span>"+p+"</span> = </strong><span>"+h+"</span>%</td>",i+='<td style="background:#7fff7f">Estimated Comission for this product: <strong>$'+(m=m*h/100)+"</strong></td>",i+="</tr>",i+="</table>",i+="</div>",i+='<div class="aext-area2" style="display:none">',i+='<table id="tableAextRelatedProducts" class="aext-related-products">',i+="<thead>",i+="<tr>",i+="<th>Image</th>",i+="<th>ASIN</th>",i+='<th>Price<span id="btnSortByPrice" style="color:#ffa41c; cursor: pointer;">▼</span></th>',i+='<th>Rating<span style="color:#ffa41c">★</span></th>',i+='<th>Review Count<span id="btnSortByReviews" style="color:#ffa41c; cursor: pointer;">▼</span></th>',i+='<th data-tooltip="Total Videos">TV <span class="ii">i</span><span id="btnSortByTV" style="color:#ffa41c; cursor: pointer;">▼</span></th>',i+='<th data-tooltip="Merchant Videos">MV <span class="ii">i</span></th>',i+='<th data-tooltip="Influencer Videos">IV <span class="ii">i</span></th>',i+='<th data-tooltip="Estimated Commission per Sale">ECS <span class="ii">i</span><span id="btnSortByECS" style="color:#ffa41c; cursor: pointer;">▼</span></th>',i+="</tr>",i+="</thead>",i+="<tbody>";for(s=0;s<t.product_carousels.length;s++)for(var f=t.product_carousels[s],v=0;v<f.products.length;v++){var g=f.products[v];i+='<tr class="loading" data-asin="'+g.asin+'">',i+='<td><a href="https://www.amazon.com/dp/'+g.asin+'" target="_blank"><img src="'+g.image+'"></a></td>',i+='<td><a href="https://www.amazon.com/dp/'+g.asin+'" target="_blank">'+g.asin+"</a>",i+="</td>",i+="<td>"+g.price+"</td>",i+='<td class="rt">'+g.rating+"</td>",i+="<td>"+g.review_count+"</td>",i+='<td class="tv"></td>',i+='<td class="mv"></td>',i+='<td class="iv"></td>',i+='<td class="ecs"></td>',i+="</tr>"}i+="</tbody>",i+="</table>",i+="</div>",l()})},4500)}});var d=function(){!1===n&&(jsPanel.ziBase=9999,n=jsPanel.create({theme:{bgPanel:"#0168f8",bgContent:"#fff",colorHeader:"#fff",border:"thin solid #0168f8",borderRadius:".33rem"},headerLogo:'<img src="'+chrome.runtime.getURL("assets/images/icon-16.png")+'" alt="'+chrome.i18n.getMessage("extName")+'">',headerTitle:"VidPeek",syncMargins:!0,panelSize:{width:()=>Math.min(900,.9*window.innerWidth),height:()=>Math.min(520,.8*window.innerHeight)},css:{panel:"aextPanel"},content:i||o,onclosed:function(){n=!1}}))},l=function(){n&&t(".jsPanel-content",n).html(i)};t(document).on("click",".aextPanel button[data-copy]",function(e){navigator.clipboard.writeText(t(this).data("copy"))}),t(document).on("click","#btnSortByReviews",function(e){"▼"===t("#btnSortByReviews").text()?t("#btnSortByReviews").text("▲"):t("#btnSortByReviews").text("▼"),h(4,"▲"===t("#btnSortByReviews").text()?2:1)}),t(document).on("click","#btnSortByPrice",function(e){"▼"===t("#btnSortByPrice").text()?t("#btnSortByPrice").text("▲"):t("#btnSortByPrice").text("▼"),h(2,"▲"===t("#btnSortByPrice").text()?2:1)}),t(document).on("click","#btnSortByTV",function(e){"▼"===t("#btnSortByTV").text()?t("#btnSortByTV").text("▲"):t("#btnSortByTV").text("▼"),h(5,"▲"===t("#btnSortByTV").text()?2:1)}),t(document).on("click","#btnSortByECS",function(e){"▼"===t("#btnSortByECS").text()?t("#btnSortByECS").text("▲"):t("#btnSortByECS").text("▼"),h(8,"▲"===t("#btnSortByECS").text()?2:1)});var u=function(){if(p){var e=t("table.aext-related-products tr.loading");if(e.length>0){var a=t(e[0],n);r(a.data("asin"),a,function(t,e){e.find("td.rt").text(t.rating),e.find("td.tv").text(t.top_carousel.videos.length),e.find("td.mv").text(t.top_carousel.videos.length-t.top_carousel.influencer_video_count),e.find("td.iv").text(t.top_carousel.influencer_video_count);for(var a="4",o=0;o<c.length;o++)c[o][0]==t.category&&(a=c[o][2]);var s=parseInt(t.price.replace(/[\D\.]+/,""));s=s*a/100,e.find("td.ecs").text("$"+s),e.removeClass("loading"),u()})}}},h=function(t,e){const a=e;let o=document.getElementById("tableAextRelatedProducts"),s=Array.from(o.tBodies[0].rows);s.sort((e,o)=>{if(2===t||8===t){const s=e.cells[t].innerText.toLowerCase(),r=o.cells[t].innerText.toLowerCase(),n=/[\d.]+/,i=""==s?0:parseFloat(s.match(n)[0]),c=""==r?0:parseFloat(r.match(n)[0]);return 1===a?i-c:c-i}{const s=parseFloat(e.cells[t].innerText.toLowerCase()),r=parseFloat(o.cells[t].innerText.toLowerCase());return 1===a?s-r:r-s}});const r=document.createElement("tbody");s.forEach(t=>{r.appendChild(t)}),o.replaceChild(r,o.tBodies[0])},p=!1;t(document).on("click",".aextPanel button.aext-related-product",function(e){p?(p=!1,t(".aext-area2",n).hide(),t(".aext-area1",n).show(),t(this).text("Related products")):(p=!0,t(".aext-area1",n).hide(),t(".aext-area2",n).show(),u(),t(this).text("Product details"))}),chrome.runtime.onMessage.addListener(function(t,a,o){"open"===t&&e.click()})}else{const a=/https:\/\/www\.amazon\.com\/s\?k=/,s=window.location.href;if(a.test(s)){e=t('<div class="aext-btn"><img src="'+chrome.runtime.getURL("assets/images/icon-64.png")+'" alt="'+chrome.i18n.getMessage("extName")+'"></div>');t("body").append(e);o='<div class="bloading"><div class="lds-ring"><div></div><div></div><div></div><div></div></div><p>Loading Data</p></div>',n=!1,i="";var m=[];c=[["luxury","Luxury Stores","5"],["luxury-beauty","Premium Beauty","5"],["luxurystores","Luxury Stores","5"],["garden","Home & Kitchen","4"],["tools","Tools & Home Improvement","4"],["lawngarden","Garden & Outdoor","4"],["pets","Pet Supplies","4"],["electronics","Electronics","3"],["beauty","Beauty & Personal Care","3"],["mi","Musical Instruments","3"],["local-services","Home & Business Services","3"],["digital-music","Digital Music","2.50"],["grocery","Grocery & Gourmet Food","2.50"],["digital-video","Digital Video","2.50"],["book","Book","2.25"],["stripbooks","Books","2.25"],["sporting","Sports & Outdoors","2.25"],["kitchen","Kitchen & Dining","2.25"],["automotive","Automotive Parts & Accessories","2.25"],["baby-products","Baby","2.25"],["fashion","Clothing, Shoes & Jewelry","2"],["fashion-womens","Womens","2"],["fashion-womens-shoes","Womens shoes","2"],["fashion-mens","Mens","2"],["fashion-mens-shoes","Mens Shoes","2"],["fashion-girls","Girls","2"],["fashion-boys","Boys","2"],["fashion-baby","Baby","2"],["fashion-luggage","Luggage & Travel Gear","2"],["fashion-womens-watches","Women's Watches","2"],["fashion-mens-watches","Men's Watches","2"],["fashion-girls-watches","Girls' Watches","2"],["fashion-boys-watches","Boys' Watches","2"],["fashion-womens-accessories","Women's Accessories","2"],["fashion-mens-accessories","Men's Accessories","2"],["fashion-girls-accessories","Girl's Accessories","2"],["fashion-boys-accessories","Boy's Accessories","2"],["toys-and-games","Toys","1.50"],["amazonfresh","Amazon Fresh","1.50"],["computers","Computers","1.25"],["movies-tv","Amazon Fresh","1.25"],["television","Television","1"],["gift-cards","Gift Cards","0"],["mobile-apps","Mobile Apps","0"],["instant-video","Prime Video","0"]];e.on("click",function(){if(!n&&(d(),!i)){var e=t(document),a=e.scrollTop();t("html, body").animate({scrollTop:2*e.height()},2e3).animate({scrollTop:0},1500).animate({scrollTop:a},500),setTimeout(function(){i+='<button class="aext-related-product">3 Best Products</button>',i+='<div class="aext-area2" style="display: none">',i+='<table id="tableAext3BestProducts" class="aext-related-products">',i+="<thead>",i+="<tr>",i+="<th>Image</th>",i+="<th>ASIN</th>",i+="<th>Price</th>",i+='<th>Rating<span style="color:#ffa41c">★</span></th>',i+="<th>Review Count</th>",i+='<th data-tooltip="Total Videos">TV</th>',i+='<th data-tooltip="Estimated Commission per Sale">ECS<span class="ii">i</span></th>',i+="</tr>",i+="</thead>",i+="<tbody>",i+="</tbody>",i+="</table>",i+="</div>";var e=[],a=document.querySelector(".s-main-slot.s-result-list.s-search-results.sg-row");if(a){a.querySelectorAll('[data-asin]:not([data-asin=""])').forEach(a=>{try{const o=t(a).attr("data-asin"),s=a.querySelectorAll("img")[0].getAttribute("src"),r=a.querySelector(".a-offscreen").innerText,n=parseFloat(a.querySelector(".a-icon.a-icon-star-small.a-star-small-4-5.aok-align-bottom").innerText),i=0;e.push({asin:o,image:s,price:r,rating:n,review_count:i})}catch(t){}}),i+='<div class="aext-area1">',i+='<table id="tableAextSearchedProducts" class="aext-related-products">',i+="<thead>",i+="<tr>",i+="<th>Image</th>",i+="<th>ASIN</th>",i+='<th>Price<span id="btnSortByPrice" style="color:#ffa41c; cursor: pointer;">▼</span></th>',i+='<th>Rating<span style="color:#ffa41c">★</span></th>',i+='<th>Review Count<span id="btnSortByReviews" style="color:#ffa41c; cursor: pointer;">▼</span></th>',i+='<th data-tooltip="Total Videos">TV <span class="ii">i</span><span id="btnSortByTV" style="color:#ffa41c; cursor: pointer;">▼</span></th>',i+='<th data-tooltip="Merchant Videos">MV <span class="ii">i</span></th>',i+='<th data-tooltip="Influencer Videos">IV <span class="ii">i</span></th>',i+='<th data-tooltip="Estimated Commission per Sale">ECS <span class="ii">i</span><span id="btnSortByECS" style="color:#ffa41c; cursor: pointer;">▼</span></th>',i+="</tr>",i+="</thead>",i+="<tbody>";for(var o=0;o<e.length;o++){const t=e[o];i+='<tr class="loading" data-asin="'+t.asin+'">',i+='<td><a href="https://www.amazon.com/dp/'+t.asin+'" target="_blank"><img src="'+t.image+'"></a></td>',i+='<td><a href="https://www.amazon.com/dp/'+t.asin+'" target="_blank">'+t.asin+"</a>",i+="</td>",i+="<td>"+t.price+"</td>",i+='<td class="rt">'+t.rating+"</td>",i+='<td class="reviewCount">'+t.review_count+"</td>",i+='<td class="tv"></td>',i+='<td class="mv"></td>',i+='<td class="iv"></td>',i+='<td class="ecs"></td>',i+="</tr>"}i+="</tbody>",i+="</table>",i+="</div>",l(),g()}},4500)}});d=function(){!1===n&&(jsPanel.ziBase=9999,n=jsPanel.create({theme:{bgPanel:"#0168f8",bgContent:"#fff",colorHeader:"#fff",border:"thin solid #0168f8",borderRadius:".33rem"},headerLogo:'<img src="'+chrome.runtime.getURL("assets/images/icon-16.png")+'" alt="'+chrome.i18n.getMessage("extName")+'">',headerTitle:"VidPeek",syncMargins:!0,panelSize:{width:()=>Math.min(900,.9*window.innerWidth),height:()=>Math.min(520,.8*window.innerHeight)},css:{panel:"aextPanel"},content:i||o,onclosed:function(){n=!1}}))},l=function(){n&&t(".jsPanel-content",n).html(i)};t(document).on("click",".aextPanel button[data-copy]",function(e){navigator.clipboard.writeText(t(this).data("copy"))}),t(document).on("click","#btnSortByReviews",function(e){"▼"===t("#btnSortByReviews").text()?t("#btnSortByReviews").text("▲"):t("#btnSortByReviews").text("▼"),h(4,"▲"===t("#btnSortByReviews").text()?2:1)}),t(document).on("click","#btnSortByPrice",function(e){"▼"===t("#btnSortByPrice").text()?t("#btnSortByPrice").text("▲"):t("#btnSortByPrice").text("▼"),h(2,"▲"===t("#btnSortByPrice").text()?2:1)}),t(document).on("click","#btnSortByTV",function(e){"▼"===t("#btnSortByTV").text()?t("#btnSortByTV").text("▲"):t("#btnSortByTV").text("▼"),h(5,"▲"===t("#btnSortByTV").text()?2:1)}),t(document).on("click","#btnSortByECS",function(e){"▼"===t("#btnSortByECS").text()?t("#btnSortByECS").text("▲"):t("#btnSortByECS").text("▼"),h(8,"▲"===t("#btnSortByECS").text()?2:1)});var f=!1;t(document).on("click",".aextPanel button.aext-related-product",function(e){f?(f=!1,t(".aext-area2",n).hide(),t(".aext-area1",n).show(),t(this).text("3 Best Products")):(f=!0,t(".aext-area1",n).hide(),t(".aext-area2",n).show(),t(this).text("Searched Products"))});var v=[],g=function(){var e=t("table.aext-related-products tr.loading");if(e.length>0)for(var a=0;a<e.length;a++){var o=t(e[a],n);r(o.data("asin"),o,function(a,o){o.find("td.rt").text(a.rating),o.find("td.tv").text(a.top_carousel.videos.length),o.find("td.mv").text(a.top_carousel.videos.length-a.top_carousel.influencer_video_count),o.find("td.iv").text(a.top_carousel.influencer_video_count),o.find("td.reviewCount").text(a.review_count);for(var s="4",r=0;r<c.length;r++)c[r][0]==a.category&&(s=c[r][2]);var n=parseInt(a.price.replace(/[\D\.]+/,""));if(n=n*s/100,a.estimated=n,o.find("td.ecs").text("$"+n),o.removeClass("loading"),v.push(a),v.length>e.length/2){v.sort((t,e)=>{const a=t.estimated;return e.estimated-a}),m=v.slice(0,Math.min(v.length,3));var i="";m.forEach(t=>{i+='<tr data-asin="'+t.asin+'">',i+='<td><a href="https://www.amazon.com/dp/'+t.asin+'" target="_blank"><img src="'+t.image+'"></a></td>',i+='<td><a href="https://www.amazon.com/dp/'+t.asin+'" target="_blank">'+t.asin+"</a>",i+="</td>",i+="<td>"+t.price+"</td>",i+='<td class="rt">'+t.rating+"</td>",i+='<td class="reviewCount">'+t.review_count+"</td>",i+="<td>"+t.top_carousel.videos.length+"</td>",i+='<td class="ecs">$ '+t.estimated+"</td>",i+="</tr>"}),t("#tableAext3BestProducts").find("tbody").html(i)}})}};h=function(t,e){const a=e;let o=document.getElementById("tableAextSearchedProducts"),s=Array.from(o.tBodies[0].rows);s.sort((e,o)=>{if(2===t||8===t){const s=e.cells[t].innerText.toLowerCase(),r=o.cells[t].innerText.toLowerCase(),n=/[\d.]+/,i=""==s?0:parseFloat(s.match(n)[0]),c=""==r?0:parseFloat(r.match(n)[0]);return 1===a?i-c:c-i}{const s=parseFloat(e.cells[t].innerText.toLowerCase()),r=parseFloat(o.cells[t].innerText.toLowerCase());return 1===a?s-r:r-s}});const r=document.createElement("tbody");s.forEach(t=>{r.appendChild(t)}),o.replaceChild(r,o.tBodies[0])};chrome.runtime.onMessage.addListener(function(t,a,o){"open"===t&&e.click()})}}})}(jQuery);